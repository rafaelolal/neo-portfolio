{% load filters %}

<!-- Beware, some of this code is AI generated! -->
<input type="checkbox" id="menu-toggle" hidden>
<!-- Must use label tag here for some reason -->
<button class="menu-open-button" style="font-size: 1em;"><label for="menu-toggle">MENU</label></button>
<label for="menu-toggle" class="overlay"></label>

<nav class="navbar" style="height: 100vh; border-right: 1px solid #eee;">
    <ul style="list-style: none; margin: 1em; padding-left: 0px;">
        {% get_navbar_urls as urls %}
        {% for name, url in urls %}
        <li>
            <a href="{{ url }}" style="font-size: 2em;">{{ name }}</a>
            <!-- if the current request path is the same as the url, show submenu (except for skills) -->
            {% if request.path == url and name != "Skills" %}
            <ul class="submenu" style="list-style: none; padding-left: 1em;">
                {% for object in objects %}
                <!-- this will be used for quickly navigating between objects -->
                <li><a href="#{{ object.name|slugify }}">{{ object.name }}</a></li>
                {% endfor %}
            </ul>
            {% endif %}
        </li>
        {% endfor %}
    </ul>

    <div style="margin-top: auto; padding: 1em; border-top: 1px solid #eee; text-align: right;">
        <a href="mailto:{{ about.email }}">{{ about.email }}</a><br>
        <a href="{{ about.github }}" target="_blank">GitHub</a><br>
        <a href="{{ about.linkedin }}" target="_blank">LinkedIn</a>
    </div>
</nav>

<style>
    /* Base and Mobile Styles */
    .navbar {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: auto;
        /* Necessary for readability over page content */
        background: white;
        z-index: 1000;
        /* Necessary for long navigation lists */
        overflow-y: auto;
    }

    .menu-open-button {
        padding: 0.25em;
        position: fixed;
        left: 0.25em;
        top: 50%;
        writing-mode: vertical-rl;
        /* Necessary to be visible on top of page content */
        z-index: 1001;
    }

    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 999;
        display: none;
        background: rgba(0, 0, 0, 0.5);
    }

    #menu-toggle:checked~.navbar {
        display: flex;
        flex-direction: column;
    }

    #menu-toggle:checked~.overlay {
        display: block;
    }

    #menu-toggle:checked~.menu-open-button {
        display: none;
    }

    /* Desktop Styles */
    @media (min-width: 769px) {
        .navbar {
            display: flex;
            flex-direction: column;
        }

        .menu-open-button,
        .overlay {
            display: none;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const menuToggle = document.getElementById('menu-toggle');
        const submenus = document.querySelectorAll('.submenu');

        // Close menu when a nav link is clicked
        submenus.forEach(function (submenu) {
            submenu.addEventListener('click', function () {
                menuToggle.checked = false;
            });
        });

        // Function to adjust main content margin based on navbar width
        function adjustMainMargin() {
            const navbar = document.querySelector('.navbar');
            const main = document.querySelector('main');

            if (main && navbar) {
                if (window.innerWidth >= 769) {
                    // Desktop: set left margin to navbar width
                    const navbarWidth = navbar.offsetWidth;
                    main.style.marginLeft = navbarWidth + 'px';
                } else {
                    // Mobile: reset margin
                    main.style.marginLeft = '0';
                }
            }
        }

        // Adjust on load and resize
        adjustMainMargin();
        window.addEventListener('resize', adjustMainMargin);
    });
</script>